#course-lessons .discussion-module,
#course-group-work .discussion-module {
  border: 1px solid $mckinsey-grey;
  border-radius: 5px;

  *:focus {
    outline: 0;
  }

  a.new-post-btn {
    &, &:visited, &:hover, &:focus {
      margin-bottom: 0;
    }
  }
}

.lesson-content .discussion-module {
  .inline-threads {
    clear: both;
    border: none !important;
  }

  .forum-nav-sort-control {
    padding-right: 22px;
  }

  .forum-nav-sort-control, .forum-nav-filter-main-control {
    margin: 0px;
    height: auto;
    width: auto;
  }

  .thread-preview-body {
    white-space: normal !important;
  }

  .forum-nav-thread-wrapper-0 {
    width: 30px;
  }
}

#course-lessons .discussion-module {
  width: 100%;

  form.edit-post-form {
    // We don't want topics displayed in the edit form.
    .topic-wrapper {
      display: none;
    }
  }

}

#course-group-work .discussion-module {
  // Calculated ratio of group work width to course page width
  width: 760px / 511.65625px * 100%;

  // Remove option to post anonymously from the group work discussions
  .discussion-anonymous,
  label[for="new-post-anonymous"] {
    display: none;
  }
  .discussion .new-post-article .new-post-form .options::after {
    content: "";
  }
}

.bookmark-button-wrapper {
  display: none;
}

/* Rules shared with course discussion. */
/* Course discussion specific rules can be found in ../course/discusssion.scss */

#course-lessons .discussion-module,
#course-group-work .discussion-module,
#course-discussion .discussion-content {
  background: #fff !important;

  .field-input .post-type-label {
      margin: 0px;
  }

  .wmd-input {
    background-color: $pure-white;
    margin: 0px;
  }

  .thread-content-wrapper, .new-post-article {
    .post-title {
      color: $mckinsey-academy-turquoise;
      font-weight: 700;
    }

    .post-body {
      max-width: none !important;
    }

    .forum-new-post-form, .edit-post-form {

      input.field-input {
        margin-bottom: 0px;
        &::-ms-clear {
          display: none;
        }
      }

      .field-label {
        margin-bottom: 8px;
      }

      .post-field {
        .field-label {
          .field-label-text {
            font-family: "Open Sans",sans-serif;
            font-weight: 600;
          }
        }
      }

      .js-group-select {
        padding-right: rem-calc(15);
      }

      .post-option {
        margin-right: 10px;

        span.js-anon-label,
        span.js-anon-peers-label
        {
          width: 165px;
          display: inline-block;
          vertical-align: top;

          &::after {
            content: "Posting anonymously will not add engagement points.";
            color: $mckinsey-orange;
            cursor: default;
            display: block;
            font-size: 14px;
            line-height: 18px;
            width: 190px;
            float: right;
            margin-top: 4px;
          }
        }
      }
    }
  }

  .discussion-response, .comments {
    .edit-post-form {
      min-width: 600px;
      background: none;
      padding: 0;
    }
  }

  .action-button {
    .action-label {
      padding: 0 5px;
    }
  }

  .discussion-post {
    .post-context {
      .related-to-label {
        display: none;
      }
      .group-visibility-label {
        font-size: 12px;
        margin: 20px 0px 0px;
        font-style: italic !important;
        color: $mckinsey-academy-black !important;
        background-color: $pure-white;
      }
    }
  }

  .discussion-article {
    background-image: none;

    .dogear {
      background-image: url('/static/image/lesson-content/discussion/follow-dog-ear.png');
    }

    .flagged * {
      color: $mckinsey-red;
    }

    .posted-details .username,
    .discussion-response .posted-by {
      pointer-events: none;
      color: $mckinsey-dark-grey;

      &:hover {
        text-decoration: none;
        cursor: default;
      }
    }
  }

  section.discussion .discussion-article {
    &, .responses > li {
      @include drop-shadow($opacity: 0);
      border-radius: 0;
    }

    .thread-wrapper {
      max-height: none;
      width: 100%;
      background-color: $pure-white;

      .thread-main-wrapper {
        box-shadow: 0 1px 3px $thread-main-wrapper-shadow-color;
      }
    }
  }

  .js-response-list, .comments {
    list-style: none;
  }

  .responses {
    padding: 0px 40px 0px 20px;
    clear: both;

    .discussion-response {
      background-color: $bottom-page;
      padding: 20px;

      .response-header-actions {
        right: 0;
        top: 0;
      }
    }

    header {
      position: relative;
    }
  }

  .discussion-article h1 {
    font-size: 14px;
  }

  .response-count {
    float: right;
    margin-top: 5px;
    color: $response-count-color;
    font-size: 14px;
  }

  .forum-nav-thread {
    border-left: 1px solid $comment-background-color;
    border-right: 1px solid $comment-background-color;
    border-bottom: 1px solid $comment-background-color;

    &:first-child {
      border-top: 1px solid $comment-background-color;
    }
  }

  .forum-nav-thread.never-read {
    background-color: $pure-white;
  }

  .forum-nav-thread-link:hover,
  .forum-nav-thread-link:active,
  .forum-nav-thread-link:focus,
  .forum-nav-thread-link.is-active {
      background-color: $forum-nav-link-active;
  }

  /* Standard Buttons */

  .new-post-btn,
  .new-post-article .new-post-form .submit,
  .discussion-submit-post,
  .add-response .add-response-btn,
  .comments .comment-form .discussion-submit-comment,
  .discussion a.post-cancel,
  .discussion-article .post-update,
  .forum-new-post-form .submit,
  .forum-new-post-form .cancel {
    &, &:hover {
      border-color: transparent;
      background-image: none;
      text-shadow: none;
      line-height: 1;
      height: 35px;
      width: auto;
      float: right;
      @include button($button-sml, $primary-color, true);
      margin-left: $button-margin;
      padding: 10px 28px;
      white-space: nowrap;

      &:hover {
        background-color: $mckinsey-academy-blue-gray;
      }
    }
  }

  a.new-post-btn {
    text-transform: lowercase;
    &:first-letter {
      text-transform: capitalize;
    }

    .new-post-icon {
      display: none;
    }
  }

  .post-extended-content {
    ol.responses.js-response-list {
      margin-left: 0;
      li.forum-response {
        margin: 0;
        box-shadow: 3px 3px 0 0 $forum-response-list-shadow-color;
        background-color: $bottom-page;
        border: 1px solid $forum-response-list-border-color;
      }
    }
  }

  .discussion-article, .new-post-article {
    .post-update,
    a.post-cancel, a.cancel {
      &, &:visited, &:hover, &:focus {
        margin: 15px 0px;
      }
    }

    a.post-cancel, a.cancel {
      &, &:visited, &:hover, &:focus {
        float: left;
      }
    }
  }

  .add-response .add-response-btn {
    &, &:hover, &:focus {
      padding-bottom: 25px;
    }

    .icon-reply {
      display: none;
    }

    text-transform: lowercase;
  }

  .vote-btn {
    &, &:hover {
      @include drop-shadow($opacity: 0);
      border-radius: 0px;
      background-image: none;
      z-index: 98; // to appear below modal dialog overlay
    }

    &.is-cast {
      background-color: $mckinsey-academy-bright-gray;
      background-image: none;
      color: $mckinsey-academy-black;
      text-shadow: none;
      box-shadow: none;
      border-color: $mckinsey-academy-discussion-icon-gray;

      .plus-icon {
        background-position: 0 0;
      }
    }
  }

  .comments .comment-form .discussion-submit-comment {
    &, &:hover {
      margin-top: 15px;
    }
  }

  .comments {
    box-shadow: 0 1px 3px -1px $comment-shadow-color inset;
    border-radius: 0 0 3px 3px;
    padding: 0;
    margin: 0;

    >li {
      border-top: 1px solid $comment-list-border-color;
      padding: 10px 20px;
    }

    .comment-form::after {
      clear: both;
      content: "";
      display: table;
    }
  }

  /* Text Edit Form */

  .wmd-panel .wmd-button span {
    background-image: url("/static/image/lesson-content/discussion/wmd-buttons-transparent.png");
  }

  .wmd-panel {
    min-width: 340px;
  }

  span[id*='wmd-code-button-'],
  span[id*='wmd-image-button-'] {
    display: none;
  }

  span[id*='wmd-olist-button-new-post-'],
  span[id*='wmd-ulist-button-new-post-'],
  span[id*='wmd-heading-button-new-post-'],
  span[id*='wmd-hr-button-new-post-'],
  span[id*='wmd-undo-button-new-post-'],
  span[id*='wmd-redo-button-new-post-'] {
    margin-left: -50px;
  }

  span[id*='wmd-spacer2-new-post-'],
  span[id*='wmd-spacer3-new-post-'] {
    margin-left: -39px;
  }

  /* Course discussion banners */
  .username-wrapper {
    white-space: nowrap;
  }

  .user-label-staff, .user-label-community-ta {
    position: relative;
    padding: 0;
    margin: 0;
    width: 80px;
    display: inline-block;

    &:before {
      width: 80px;
      content: "McKinsey TA";
      text-transform: uppercase;
      color: white;
      background-color: $mckinsey-academy-alt-blue;
      text-align: center;
      white-space: nowrap;
      position: absolute;
    }
  }

  /* Home */

  .home-header {

    border-bottom: none;

    .home-title{
      display: none;
    }

    .label {
      @include font-spec(22px, normal, 24);
      padding: 0px 0px 10px 0px;
      color: transparent;

      &:before {
        content: 'Discussion';
        color: $mckinsey-academy-turquoise;
        position: absolute;
        display: block;
      }
    }


    .home-title {
      color: $mckinsey-dark-grey;
      padding: 0px 0px 10px 0px;
      @include font-spec(18, normal, 24)
    }
  }

  .notification-checkbox {
    display: none;
  }

  .home-helpgrid {
    box-shadow: none;
    margin-right: 5px;
  }

  .helpgrid-row {
    td {
      border: 1px solid $mckinsey-academy-discussion-icon-gray;
    }

    .row-title {
      background-color: transparent;
      padding: 10px;
      font-size: 14px;
      font-weight: bold;
    }

    .row-item {
      padding: 10px;

      .row-description {
        display: block;
        text-transform: lowercase;
        &:first-letter {
          text-transform: capitalize;
        }
      }

      .icon {
        width: 100%;
        text-align: center;
        display: inline-block;
        padding: 0px;
      }
    }
  }

  .helpgrid-row-notification {
    .row-item-full {
      &::before {
        content: "You can enable daily\0020(or weekly) notification digests which show discussion activity by accessing your profile dropdown.";
      }
      .row-description {
        display: none;
      }
    }
  }

  .forum-thread-expand,
  .forum-thread-collapse {
    margin: 0;
    background-color: transparent;
    color: $forum-thread-collapse-color;
    box-shadow: none;
  }

  .action-button,
  .action-list-item {
    margin: 0;
    background-color: transparent;
    box-shadow: none;
  }

  .action-button {
    padding: 1px;
    &:hover, &:active, &:focus {
      background-color: $pure-white;
    }
  }

  .action-list-item {
    width: 100%;
  }

  .actions-dropdown-list {
    background-color: $pure-white;
  }

  button.cancel {
    &, &:hover, &:visited, &:active {
      float: left !important;
      margin: 15px 0 !important;
    }
  }

  .post-type-input:checked+.post-type-label {
    background-color: $forum-nav-link-active;
    color: $post-input-label-checked-color;
  }
}

/* Alert messages */

#discussion-alert-message {
  color: $mckinsey-academy-black;
}

.modal .discussion-alert-wrapper button {
  border-radius: 5px;
  color: #0075b4;
  text-shadow: none;

  &:hover {
    color: $pure-white;
  }
}

.wmd-prompt-dialog {
  background-color: $mckinsey-academy-blue-gray;
  border-radius: 5px;
}

/* Discussion tooltip gets added by JS to the <body> :/ */
body > .tooltip {
  width: 100px;
  margin-top: -110px;
  text-align: center;
}

/* Special Close button for modals and New Post */
#course-discussion .discussion-content a.new-post-cancel,
#course-lessons .discussion-module .discussion a.new-post-cancel,
#course-group-work .discussion-module .discussion a.new-post-cancel,
.modal .inner-wrapper .close-modal.dismiss {
    width: 1.5em;
    height: 1.5em;
    border-radius: 50%;
    border: none;
    background-color: transparent;
    background-image: url("/static/image/lesson-content/discussion/close_button.png");
    background-size: 100%;
    opacity: 0.5;
    color: transparent;
    overflow: hidden;
    text-indent: 3em;
    position: absolute;
    top: 10px;
    right: 10px;
    margin: 0;
    padding: 0;

    &:hover {
      background-image: url("/static/image/lesson-content/discussion/close_button.png");
      opacity: 0.7;
    }
}

#course-group-work .discussion-module,
#course-lessons .discussion-module {
  padding: 20px;
  margin: 20px 0;
  @media only screen and
  (max-width: 767px){
    padding: 15px;
  }
}

.discussion-show {
  padding-top: 0.7rem !important;
  margin-top: 4px !important;
  line-height: normal !important;

  font-size: 13px !important;
  font-weight: bold !important;
}

.is-hidden {
  display: none;
}

.sr, .sr-only {
  display: none;
}

.lesson-content .wmd-button {
  position: absolute;
  background: none;
  padding-left: 0px;
  padding-top: 0px;
  box-shadow: none;
}

.lesson-content .new-post-btn,
.lesson-content .all-posts-btn,
.lesson-content .add-post-cancel {
  background: transparent !important;
  box-shadow: none !important;
  color: #0075b4 !important;
}

.lesson-content .all-posts-btn {
  font-size: 1.2rem;
  padding: 0px !important;
}

.lesson-content .discussion-module .post-header-content {
  padding-top: 10px;
}

.lesson-content .discussion-module .forum-nav-thread-list {
  overflow-y: inherit;
}

.lesson-content .discussion-module .thread-main-wrapper {
  border: 1px solid $mckinsey-grey;
}

.row.collapse {
  display: block;
}

@media only screen and
(max-width: 767px){
  .discussion-module{
    border-radius: 4px !important;
    .discussion-module-header{
      float: none !important;
      width: 100% !important;
      .discussion-module-title{
        color: $mckinsey-dark-blue;
        margin-bottom: 15px !important;
        font-weight: 600;
        @include font-spec(15, 600);
      }
    }
    .forum-nav-bar{
      border-bottom: 1px solid $mckinsey-academy-light-gray;
      border-top: 1px solid $mckinsey-academy-light-gray;
      .all-posts-btn{
        margin-bottom: 0;
        font-weight: 600 !important;
        color: $mckinsey-light-blue !important;
        width: 100%;
        .fa{
          &:before{
            content: "\f053";
          }
        }
      }
    }
    .forum-content{
      padding: 0 10px;
      .thread-main-wrapper{
        border: 0;
        box-shadow: none !important;
        .discussion-post{
          position: relative;
          .post-header-content{
            max-width: none;
            width: calc(100% - 30px);
            .post-title{
              @include font-spec(15);
              font-weight: 600 !important;
              line-height: normal;
              color: $mckinsey-dark-blue !important;
            }
            .posted-details{
              font-size: 12px;
              .username{
                color: $mckinsey-light-blue !important;
                font-size: 12px;
              }
            }
          }
          .post-body{
            width: calc(100% - 30px);
            p{
              font-size: 12px;
              color: $mckinsey-dark-blue;
            }
          }
          .group-visibility-label{
            margin-top: 10px !important;
            padding-bottom: 15px;
            border-bottom: 1px solid $mckinsey-academy-light-gray;
          }
          .post-header-actions{
            float: right;
            position: absolute;
            right: 0;
            top: 0;
          }
        }
      }
      .response-btn-count-wrapper{
        display:  none !important;
        visibility: hidden !important;
      }
      .responses{
        padding: 0 !important;
        margin-top: 10px;
        margin-bottom: 20px;
        > li{
          background-color: transparent !important;
          border: 0 !important;
          border-left: 3px solid $mckinsey-academy-light-gray !important;
          box-shadow: none !important;
          margin-top: 2px !important;
          .discussion-response{
            min-height: 75px !important;
            background-color: transparent !important;
            padding: 10px 0 10px 15px !important;
            .response-body{
              p{
                font-size: 12px;
              }
            }
          }
          &:first-child{
            .discussion-response{
              padding: 0 0 10px 15px !important;
            }
          }
        }
        .comments{
          background-color: transparent !important;
          box-shadow: none !important;
          > li{
            position: relative;
            border-left: 16px solid $mckinsey-academy-light-gray !important;
            padding: 10px 0 10px 10px !important;
            &:before{
              content: "\f149";
              position: absolute;
              font-family: 'FontAwesome';
              left: -13px;
              top: 50%;
              transform: rotate(180deg) translateY(-50%);
              line-height: 0;
              color: $pure-white;
            }
            &:last-child{
              border-left: 0 !important;
              border-bottom: 1px solid $mckinsey-academy-light-gray !important;
              &:before{
                display: none;
                visibility: hidden;
              }
            }
            &.new-comment{
              padding: 0 10px !important;
              form{
                padding: 0 !important;
                textarea{
                  margin-left: 10px !important;
                  font-size: 13px;
                  border: 0;
                  box-shadow: none;
                  resize: none;
                }
              }
            }
          }
          .comment-actions-list{
            right: 0 !important;
          }
          .response-body{
            font-size: 12px;
            p{
              font-size: 12px;
            }
          }
          .posted-details{
            display: none;
          }
        }
        .response-header-content{
          .username{
            font-size: 13px;
            color: $mckinsey-light-blue;
            font-weight: 600;
          }
          .posted-details{
            display: none;
          }
        }
      }
      .response-pagination{
        display: none !important;
      }
      .discussion-reply-new{
        h4{
          font-size: 15px;
          color: $mckinsey-dark-blue;
          font-weight: 600;
        }
      }
      button[class*="submit"]{
        background-color: $mckinsey-light-blue !important;
      }
    }
    .add_post_btn_container{
      height: 5px !important;
    }
    .inline-threads{
      margin-left: -15px;
      margin-right: -15px;
      border: 0 !important;
      .forum-nav-thread{
        position: relative;
        border-left: 0 !important;
        border-right: 0 !important;
        &:last-child{
          border-bottom: 0 !important;
          border-radius: 0 0 4px 4px !important;
        }
        .forum-nav-thread-wrapper-0{
          display: none;
        }
        .forum-nav-thread-wrapper-1{
          max-width: none;
          padding: 0;
          margin: 0;
        }
        .forum-nav-thread-wrapper-2{
          min-width: 30px;
        }
        .forum-nav-thread-link{
          border:  0 !important;
          padding: 20px 15px !important;
          .forum-nav-thread-wrapper-1{

          }
        }
        .forum-nav-thread-title{
          @include font-spec(15, 600);
          color: $mckinsey-dark-blue;
        }
        .forum-nav-thread-comments-count{
          background-color: $mckinsey-bubble-gray !important;
          border-radius: 50%;
          color: $pure-white;
          padding: 3px !important;
          width: 26px;
          height: 24px;
          position: absolute;
          right: 15px;
          top: 15px;
          &:after{
            right: auto;
            left: 1px;
            border-width: 0 7px 7px 0;
            transform: skewX(130deg);
            border-color: transparent $mckinsey-bubble-gray transparent transparent;
          }
        }
      }
      .posted-details{
        font-size: 12px;
        color: $mckinsey-bubble-gray;
        .username{
          font-size: 12px;
          color: $mckinsey-light-blue;
        }
      }
      .thread-preview-body{
        font-size: 12px;
        color: $mckinsey-dark-blue;
        p{
          line-height: 20px;
          font-size: 12px;
        }
      }
      .forum-nav-thread-labels{
        display: none;
      }
      .group-visibility-label{
        color: $mckinsey-bubble-gray !important;
      }
    }
    .inline-discussion-topic{
      font-size: 13px !important;
      color: $mckinsey-dark-blue;
      .inline-discussion-topic-title{
        font-weight: 600 !important;
      }
    }
    .discussion-show{
      width: 100%;
      margin-bottom: 10px !important;
      &.shown{
        display: none;
      }
    }
    .new-post-btn{
      position: fixed !important;
      bottom: -10px;
      z-index: 10005;
      margin-left: 0 !important;
      left: calc(50% - 54px);
      border-radius: 100px !important;
      background-color: $mckinsey-light-blue !important;
      color: $pure-white !important;
      padding: 0 20px !important;
      font-weight: 600 !important;
    }
    .new-post-article{
      .forum-new-post-form {
        padding: 15px 10px;
        .thread-title,
        .add-post-cancel,
        .field-help {
          display: none !important;
          visibility: hidden;
        }
        .field-label-text {
          margin-bottom: 10px !important;
          display: block;
        }
        .field-input {
          width: 100% !important;
        }
        .post-options {
          margin-bottom: 0 !important;
        }
      }
    }
    fieldset.field-input{
      width: 100% !important;
      .post-type-label{
        float: left;
        padding: 0 15px;
        width: 50%;
        &[for*="question"]{
          border-radius: 3px 0 0 3px;
          &[for*="discussion"]{
            border-radius: 0 3px 3px 0;
            border-left: 0;
          }
        }
        &:focus, &:active{
          outline: 0;
          box-shadow: none;
        }
      }
    }
    .wmd-panel{
      min-width: auto !important;
    }
    .wmd-preview-container{
      display: none !important;
    }
    button.submit{
      margin-top: 15px !important;
    }
    .post-type-input{
      &:checked{
        &+.post-type-label{
          background-color: $primary-color !important;
          color: $pure-white !important;
        }
      }
    }
    .wmd-button-row{
      display: none !important;
      visibility: hidden !important;
    }
    .inline-thread{
      border: 0 !important;
      margin-left: -15px;
      margin-right: -15px;
    }
  }
}