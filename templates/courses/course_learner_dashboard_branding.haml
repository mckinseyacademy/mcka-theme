%script
  - if branding
    - if branding.background_image
      - if branding.get_background_style_display == 'Stretched'
        $('body').css('background-repeat', 'no-repeat');
        $('body').css('background-size', '100% 100%');
      - else
        - if branding.get_background_style_display == 'Normal'
          var window_object = $(window);
          var body_object = $('body');
          body_object.css('background-repeat', 'no-repeat');
          var header_height = parseInt($("#learner-dashboard-header").outerHeight());
          var window_height = parseInt(window_object.height());
          body_object.css('background-position', 'center '+header_height+'px');
          body_object.css('background-size', 'auto '+(window_height-header_height)+'px');

          var background_image = new Image();
          var background_image_height=0;
          var background_image_width=0;
          var scaled_height = 0;
          // just in case it is not already loaded
          $(background_image).load(function () {
              background_image_width=background_image.width;
              background_image_height=background_image.height;
              scaled_height = background_image_height*960/background_image_width;
              body_object.css('min-height', 'auto '+scaled_height+'px');
          });
          background_image.src = "/company_images/#{branding.background_image}";

          window_object.on("scroll", function(e){
            var width_available = parseInt(window_object.width());
            var height_available = parseInt(window_object.height()) - header_height;
            if (window.scrollY<=header_height){
              if (width_available<=960){
                if (height_available<=scaled_height){
                  body_object.css('background-size', '960px '+scaled_height+"px");
                  body_object.css('background-position', '0px '+(header_height-window.scrollY)+'px');
                }
                else{
                  body_object.css('background-position', '0px '+ (header_height-window.scrollY) +'px');
                  body_object.css('background-size', '960px '+(scaled_height+window.scrollY)+"px");
                }
              }
              else{
                if (height_available<=scaled_height){
                  body_object.css('background-size', '960px '+scaled_height+"px");
                  body_object.css('background-position', 'center '+ (header_height-window.scrollY)+'px');
                } 
                else{
                  body_object.css('background-size', 'auto '+(height_available+window.scrollY)+"px");
                  body_object.css('background-position', 'center '+ (header_height-window.scrollY)+'px');
                }
              }
            }
            else{
              if (width_available<=960){
                body_object.css('background-size', '960px '+scaled_height+"px");
                body_object.css('background-position', '0px 0px');
              }
              else{
                if (height_available<=scaled_height)
                  body_object.css('background-size', '960px '+scaled_height+"px");
                else
                  body_object.css('background-size', 'auto '+window_height+'px');
                body_object.css('background-position', 'center 0px');
              }
            }
          });
          window_object.on("resize", function(e){
            var width_available = parseInt(window_object.width());
            var height_available = parseInt(window_object.height()) - header_height;
            if (width_available<=960){
              if (height_available<=scaled_height){
                body_object.css('background-size', '960px '+scaled_height+"px");
                body_object.css('background-position', '0px '+header_height+'px');
              }
              else{
                body_object.css('background-size', '960px '+scaled_height+"px");
                body_object.css('background-position', '0px '+header_height+'px');
              }
            }
            else{
              if (height_available<=scaled_height){
                body_object.css('background-size', '960px '+scaled_height+"px");
                body_object.css('background-position', 'center '+header_height+'px');
              }
              else{
                body_object.css('background-size', 'auto '+height_available+'px');
                body_object.css('background-position', 'center '+header_height+'px');
              } 
            }
          });
        - else 
          - if branding.get_background_style_display == 'Tiled'
            $('body').css('background-repeat', 'repeat');
      $('body').css('background-image', 'url(/company_images/#{branding.background_image})');
      $('body').addClass("learner-dashboard-view");

    - else
      - if branding.background_color
        $('body').css('background-color', '#{branding.background_color}');

      if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
        if (window.matchMedia("(orientation: portrait)").matches) {
           alert("Optimized for landscape view, please rotate your device.");
        }
      }
  $('body').css('margin-top', '0');